<style type="text/css">
    label {

        margin-bottom: 10px;
    }

    .btn-success {
        margin-left: 15px;
    }
</style>

<h3 class="topic">Assign Device to an Employee</h3>
<div class="detailWrapper">
    <div id="assign_device_employee">
        <div class="form-row">
            <div class="form-group col-md-6">
                <label>Employee Name: </label>
                <input class="form-control" placeholder="Employee Name" id="employeeNames">
            </div>
        </div>

        <div class="clearfix"></div>

        <div class="form-row">
            <div class="form-group col-md-6">
                <label>Device Name: </label>
                <input class="form-control" placeholder="Device Name" id="deviceNames">
            </div>
        </div>
    </div>

    <div class="clearfix"></div>

    <button id="submit_userdevice" class="btn btn-success">Submit</button>
</div>
<input type="hidden" id="employeeDetailId" name="employeeDetailId" />
<input type="hidden" id="deviceDetailId" name="deviceDetailId" />
<script>
    var allDeviceNames = [];
    var empNames = [];
    $("#submit_userdevice").click(function() {
        if (($("#employeename").val() != "") && ($("#devicename").val() != "")) {

            saveUserDevice();
        } else {
            alert("Please fill the feilds");
        }
    });

    function saveUserDevice() {
    	$.ajax({
            url: 'device/saveDeviceAssignment',
            dataType: 'json',
            data: {
                employeeId: $("#employeeDetailId").val(),
                deviceId: $("#deviceDetailId").val(),

            },
            type: 'POST'
        });
		alertUserDevice()
    }
    
    function alertUserDevice(){
    	$("#employeeDetailId").val('');
    	$("#deviceDetailId").val('');
    	$("#employeeNames").val('');
    	$("#deviceNames").val('');
        alert("Employee Assign Details Successfully Saved");
    	
    }
    $(document).ready(function() {
        $.ajax({
            url: 'employee/getAllFullNames',
            dataType: 'json',
            type: 'GET',
            success: function(data) {
                setEmployeeFullNames(data);
            }
        });

        $.ajax({
            url: 'device/getAllDeviceNames',
            dataType: 'json',
            type: 'GET',
            success: function(data) {
                setAllDeviceNames(data);
            }
        });
    });

    function setEmployeeFullNames(EmployeeNames) {
        for (var i = 0; i < EmployeeNames.length; i++) {
            var emp = {};
            emp.value = EmployeeNames[i].id;
            emp.label = EmployeeNames[i].fullname;
            empNames.push(emp);
        }
    }
    $("#employeeNames").autocomplete({
        source: empNames,
        select: function(event, ui) {
            $("#employeeNames").val(ui.item.label); // display the selected text
            $("#employeeDetailId").val(ui.item.value); // save selected id to hidden input
            event.preventDefault()
        }
    });

    function setAllDeviceNames(DeviceNames) {
        for (var i = 0; i < DeviceNames.length; i++) {
            var device = {};
            device.value = DeviceNames[i].id;
            device.label = DeviceNames[i].deviceName;
            allDeviceNames.push(device);
        }
    }
    $("#deviceNames").autocomplete({
        source: allDeviceNames,
        select: function(event, ui) {
            $("#deviceNames").val(ui.item.label); // display the selected text
            $("#deviceDetailId").val(ui.item.value); // save selected id to hidden input
            event.preventDefault()
        }
    });
</script>